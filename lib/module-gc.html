<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<link rel="STYLESHEET" href="lib.css" type='text/css' />
<link rel="SHORTCUT ICON" href="../icons/pyfav.png" type="image/png" />
<link rel='start' href='../index.html' title='Python documentation Index' />
<link rel="first" href="lib.html" title='Python library Reference' />
<link rel='contents' href='contents.html' title="Contents" />
<link rel='index' href='genindex.html' title='Index' />
<link rel='last' href='about.html' title='About this document...' />
<link rel='help' href='about.html' title='About this document...' />
<link rel="next" href="module-inspect.html" />
<link rel="prev" href="module-future.html" />
<link rel="parent" href="python.html" />
<link rel="next" href="module-inspect.html" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name='aesop' content='information' />
<title>26.9 gc -- Garbage Collector interface</title>
</head>
<body>
<div class="navigation">
<div id='top-navigation-panel' xml:id='top-navigation-panel'>
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class='online-navigation'><a rel="prev" title="26.8 __future__  "
  href="module-future.html"><img src='../icons/previous.png'
  border='0' height='32'  alt='Previous Page' width='32' /></a></td>
<td class='online-navigation'><a rel="parent" title="26. python Runtime Services"
  href="python.html"><img src='../icons/up.png'
  border='0' height='32'  alt='Up one Level' width='32' /></a></td>
<td class='online-navigation'><a rel="next" title="26.10 inspect  "
  href="module-inspect.html"><img src='../icons/next.png'
  border='0' height='32'  alt='Next Page' width='32' /></a></td>
<td align="center" width="100%">Python Library Reference</td>
<td class='online-navigation'><a rel="contents" title="Table of Contents"
  href="contents.html"><img src='../icons/contents.png'
  border='0' height='32'  alt='Contents' width='32' /></a></td>
<td class='online-navigation'><a href="modindex.html" title="Module Index"><img src='../icons/modules.png'
  border='0' height='32'  alt='Module Index' width='32' /></a></td>
<td class='online-navigation'><a rel="index" title="Index"
  href="genindex.html"><img src='../icons/index.png'
  border='0' height='32'  alt='Index' width='32' /></a></td>
</tr></table>
<div class='online-navigation'>
<b class="navlabel">Previous:</b>
<a class="sectref" rel="prev" href="module-future.html">26.8 __future__  </a>
<b class="navlabel">Up:</b>
<a class="sectref" rel="parent" href="python.html">26. Python Runtime Services</a>
<b class="navlabel">Next:</b>
<a class="sectref" rel="next" href="module-inspect.html">26.10 inspect  </a>
</div>
<hr /></div>
</div>
<!--End of Navigation Panel-->

<h1><a name="SECTION0028900000000000000000">
26.9 <tt class="module">gc</tt> --
         Garbage Collector interface</a>
</h1>

<p>
<a name="module-gc"></a>

<p>
This module provides an interface to the optional garbage collector.  It
provides the ability to disable the collector, tune the collection
frequency, and set debugging options.  It also provides access to
unreachable objects that the collector found but cannot free.  Since the
collector supplements the reference counting already used in Python, you
can disable the collector if you are sure your program does not create
reference cycles.  Automatic collection can be disabled by calling
<code>gc.disable()</code>.  To debug a leaking program call
<code>gc.set_debug(gc.DEBUG_LEAK)</code>. Notice that this includes 
<code>gc.DEBUG_SAVEALL</code>, causing garbage-collected objects to be
saved in gc.garbage for inspection.

<p>
The <tt class="module">gc</tt> module provides the following functions:

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-5241' xml:id='l2h-5241' class="function">enable</tt></b>(</nobr></td>
  <td><var></var>)</td></tr></table></dt>
<dd>
Enable automatic garbage collection.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-5242' xml:id='l2h-5242' class="function">disable</tt></b>(</nobr></td>
  <td><var></var>)</td></tr></table></dt>
<dd>
Disable automatic garbage collection.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-5243' xml:id='l2h-5243' class="function">isenabled</tt></b>(</nobr></td>
  <td><var></var>)</td></tr></table></dt>
<dd>
Returns true if automatic collection is enabled.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-5244' xml:id='l2h-5244' class="function">collect</tt></b>(</nobr></td>
  <td><var></var><big>[</big><var>generation</var><big>]</big><var></var>)</td></tr></table></dt>
<dd>
With no arguments, run a full collection.  The optional argument
<var>generation</var> may be an integer specifying which generation to collect
(from 0 to 2).  A <tt class="exception">ValueError</tt> is raised if the generation number 
is invalid.
The number of unreachable objects found is returned.

<p>

<span class="versionnote">Changed in version 2.5:
The optional <var>generation</var> argument was added.</span>

</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-5245' xml:id='l2h-5245' class="function">set_debug</tt></b>(</nobr></td>
  <td><var>flags</var>)</td></tr></table></dt>
<dd>
Set the garbage collection debugging flags.
Debugging information will be written to <code>sys.stderr</code>.  See below
for a list of debugging flags which can be combined using bit
operations to control debugging.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-5246' xml:id='l2h-5246' class="function">get_debug</tt></b>(</nobr></td>
  <td><var></var>)</td></tr></table></dt>
<dd>
Return the debugging flags currently set.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-5247' xml:id='l2h-5247' class="function">get_objects</tt></b>(</nobr></td>
  <td><var></var>)</td></tr></table></dt>
<dd>
Returns a list of all objects tracked by the collector, excluding the
list returned.

<span class="versionnote">New in version 2.2.</span>

</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-5248' xml:id='l2h-5248' class="function">set_threshold</tt></b>(</nobr></td>
  <td><var>threshold0</var><big>[</big><var>,
                                threshold1</var><big>[</big><var>, threshold2</var><big>]</big><var></var><big>]</big><var></var>)</td></tr></table></dt>
<dd>
Set the garbage collection thresholds (the collection frequency).
Setting <var>threshold0</var> to zero disables collection.

<p>
The GC classifies objects into three generations depending on how many
collection sweeps they have survived.  New objects are placed in the
youngest generation (generation <code>0</code>).  If an object survives a
collection it is moved into the next older generation.  Since
generation <code>2</code> is the oldest generation, objects in that
generation remain there after a collection.  In order to decide when
to run, the collector keeps track of the number object allocations and
deallocations since the last collection.  When the number of
allocations minus the number of deallocations exceeds
<var>threshold0</var>, collection starts.  Initially only generation
<code>0</code> is examined.  If generation <code>0</code> has been examined more
than <var>threshold1</var> times since generation <code>1</code> has been
examined, then generation <code>1</code> is examined as well.  Similarly,
<var>threshold2</var> controls the number of collections of generation
<code>1</code> before collecting generation <code>2</code>.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-5249' xml:id='l2h-5249' class="function">get_count</tt></b>(</nobr></td>
  <td><var></var>)</td></tr></table></dt>
<dd>
Return the current collection  counts as a tuple of
<code>(<var>count0</var>, <var>count1</var>, <var>count2</var>)</code>.

<span class="versionnote">New in version 2.5.</span>

</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-5250' xml:id='l2h-5250' class="function">get_threshold</tt></b>(</nobr></td>
  <td><var></var>)</td></tr></table></dt>
<dd>
Return the current collection thresholds as a tuple of
<code>(<var>threshold0</var>, <var>threshold1</var>, <var>threshold2</var>)</code>.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-5251' xml:id='l2h-5251' class="function">get_referrers</tt></b>(</nobr></td>
  <td><var>*objs</var>)</td></tr></table></dt>
<dd>
Return the list of objects that directly refer to any of objs. This
function will only locate those containers which support garbage
collection; extension types which do refer to other objects but do not
support garbage collection will not be found.

<p>
Note that objects which have already been dereferenced, but which live
in cycles and have not yet been collected by the garbage collector can
be listed among the resulting referrers.  To get only currently live
objects, call <tt class="function">collect()</tt> before calling
<tt class="function">get_referrers()</tt>.

<p>
Care must be taken when using objects returned by
<tt class="function">get_referrers()</tt> because some of them could still be under
construction and hence in a temporarily invalid state. Avoid using
<tt class="function">get_referrers()</tt> for any purpose other than debugging.

<p>

<span class="versionnote">New in version 2.2.</span>

</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-5252' xml:id='l2h-5252' class="function">get_referents</tt></b>(</nobr></td>
  <td><var>*objs</var>)</td></tr></table></dt>
<dd>
Return a list of objects directly referred to by any of the arguments.
The referents returned are those objects visited by the arguments'
C-level <tt class="member">tp_traverse</tt> methods (if any), and may not be all
objects actually directly reachable.  <tt class="member">tp_traverse</tt> methods
are supported only by objects that support garbage collection, and are
only required to visit objects that may be involved in a cycle.  So,
for example, if an integer is directly reachable from an argument, that
integer object may or may not appear in the result list.

<p>

<span class="versionnote">New in version 2.3.</span>

</dl>

<p>
The following variable is provided for read-only access (you can
mutate its value but should not rebind it):

<p>
<dl><dt><b><tt id='l2h-5253' xml:id='l2h-5253'>garbage</tt></b></dt>
<dd>
A list of objects which the collector found to be unreachable
but could not be freed (uncollectable objects).  By default, this list
contains only objects with <tt class="method">__del__()</tt> methods.<a name="tex2html190"
  href="#foot78228"><sup>26.1</sup></a>Objects that have
<tt class="method">__del__()</tt> methods and are part of a reference cycle cause
the entire reference cycle to be uncollectable, including objects
not necessarily in the cycle but reachable only from it.  Python doesn't
collect such cycles automatically because, in general, it isn't possible
for Python to guess a safe order in which to run the <tt class="method">__del__()</tt>
methods.  If you know a safe order, you can force the issue by examining
the <var>garbage</var> list, and explicitly breaking cycles due to your
objects within the list.  Note that these objects are kept alive even
so by virtue of being in the <var>garbage</var> list, so they should be
removed from <var>garbage</var> too.  For example, after breaking cycles, do
<code>del gc.garbage[:]</code> to empty the list.  It's generally better
to avoid the issue by not creating cycles containing objects with
<tt class="method">__del__()</tt> methods, and <var>garbage</var> can be examined in that
case to verify that no such cycles are being created.

<p>
If <tt class="constant">DEBUG_SAVEALL</tt> is set, then all unreachable objects will
be added to this list rather than freed.
</dd></dl>

<p>
The following constants are provided for use with
<tt class="function">set_debug()</tt>:

<p>
<dl><dt><b><tt id='l2h-5254' xml:id='l2h-5254'>DEBUG_STATS</tt></b></dt>
<dd>
Print statistics during collection.  This information can
be useful when tuning the collection frequency.
</dd></dl>

<p>
<dl><dt><b><tt id='l2h-5255' xml:id='l2h-5255'>DEBUG_COLLECTABLE</tt></b></dt>
<dd>
Print information on collectable objects found.
</dd></dl>

<p>
<dl><dt><b><tt id='l2h-5256' xml:id='l2h-5256'>DEBUG_UNCOLLECTABLE</tt></b></dt>
<dd>
Print information of uncollectable objects found (objects which are
not reachable but cannot be freed by the collector).  These objects
will be added to the <code>garbage</code> list.
</dd></dl>

<p>
<dl><dt><b><tt id='l2h-5257' xml:id='l2h-5257'>DEBUG_INSTANCES</tt></b></dt>
<dd>
When <tt class="constant">DEBUG_COLLECTABLE</tt> or <tt class="constant">DEBUG_UNCOLLECTABLE</tt> is
set, print information about instance objects found.
</dd></dl>

<p>
<dl><dt><b><tt id='l2h-5258' xml:id='l2h-5258'>DEBUG_OBJECTS</tt></b></dt>
<dd>
When <tt class="constant">DEBUG_COLLECTABLE</tt> or <tt class="constant">DEBUG_UNCOLLECTABLE</tt> is
set, print information about objects other than instance objects found.
</dd></dl>

<p>
<dl><dt><b><tt id='l2h-5259' xml:id='l2h-5259'>DEBUG_SAVEALL</tt></b></dt>
<dd>
When set, all unreachable objects found will be appended to
<var>garbage</var> rather than being freed.  This can be useful for debugging
a leaking program.
</dd></dl>

<p>
<dl><dt><b><tt id='l2h-5260' xml:id='l2h-5260'>DEBUG_LEAK</tt></b></dt>
<dd>
The debugging flags necessary for the collector to print
information about a leaking program (equal to <code>DEBUG_COLLECTABLE |
DEBUG_UNCOLLECTABLE | DEBUG_INSTANCES | DEBUG_OBJECTS | DEBUG_SAVEALL</code>).
</dd></dl>
<br><hr><h4>Footnotes</h4>
<dl>
<dt><a name="foot78228">... methods.</a><A
 href="module-gc.html#tex2html190"><sup>26.1</sup></a></dt>
<dd>Prior to
  Python 2.2, the list contained all instance objects in unreachable
  cycles,  not only those with <tt class="method">__del__()</tt> methods.

</dd>
</dl>
<div class="navigation">
<div class='online-navigation'>
<p></p><hr />
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class='online-navigation'><a rel="prev" title="26.8 __future__  "
  href="module-future.html"><img src='../icons/previous.png'
  border='0' height='32'  alt='Previous Page' width='32' /></a></td>
<td class='online-navigation'><a rel="parent" title="26. python Runtime Services"
  href="python.html"><img src='../icons/up.png'
  border='0' height='32'  alt='Up one Level' width='32' /></a></td>
<td class='online-navigation'><a rel="next" title="26.10 inspect  "
  href="module-inspect.html"><img src='../icons/next.png'
  border='0' height='32'  alt='Next Page' width='32' /></a></td>
<td align="center" width="100%">Python Library Reference</td>
<td class='online-navigation'><a rel="contents" title="Table of Contents"
  href="contents.html"><img src='../icons/contents.png'
  border='0' height='32'  alt='Contents' width='32' /></a></td>
<td class='online-navigation'><a href="modindex.html" title="Module Index"><img src='../icons/modules.png'
  border='0' height='32'  alt='Module Index' width='32' /></a></td>
<td class='online-navigation'><a rel="index" title="Index"
  href="genindex.html"><img src='../icons/index.png'
  border='0' height='32'  alt='Index' width='32' /></a></td>
</tr></table>
<div class='online-navigation'>
<b class="navlabel">Previous:</b>
<a class="sectref" rel="prev" href="module-future.html">26.8 __future__  </a>
<b class="navlabel">Up:</b>
<a class="sectref" rel="parent" href="python.html">26. Python Runtime Services</a>
<b class="navlabel">Next:</b>
<a class="sectref" rel="next" href="module-inspect.html">26.10 inspect  </a>
</div>
</div>
<hr />
<span class="release-info">Release 2.5.4, documentation updated on 23rd December, 2008.</span>
</div>
<!--End of Navigation Panel-->
<address>
See <i><a href="about.html">About this document...</a></i> for information on suggesting changes.
</address>
</body>
</html>
